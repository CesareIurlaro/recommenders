{
   "_id": "_design/objectUsages",
   "language": "javascript",
   "views": {
       "byFingerprint": {
           "map": "function(doc) {\n\tif(!doc.imports || !doc.primaryType)\n\t\treturn;\n\n\tvar type2fingerprint = new Object();\n\tfor(var i=0; i<doc.imports.length; i++) {\n\t\tvar _import = doc.imports[i];\n\t\ttype2fingerprint[_import.name] = _import.fingerprint;\n\t}\n\n\tfor(var i=0; i<doc.primaryType.methods.length; i++) {\n\t\tvar method = doc.primaryType.methods[i];\n\t\tfor(var j=0; j<method.objects.length; j++) {\n\t\t\tvar object = method.objects[j];\n\t\t\tvar fingerprint = type2fingerprint[object.type];\n\t\t\tif(fingerprint != null && fingerprint != \"\") {\n\t\t\t\tvar objectUsage = {\n\t\t\t\t\t\"type\" : object.type,\n\t\t\t\t\t\"contextFirst\" : method.firstDeclaration,\n\t\t\t\t\t\"contextSuper\" : method.superDeclaration,\n\t\t\t\t\t\"calls\" : []\n\t\t\t\t}\n\t\t\t\tfor(var k=0; k<object.receiverCallSites.length; k++) {\n\t\t\t\t\tobjectUsage.calls.push(object.receiverCallSites[k].targetMethod);\n\t\t\t\t}\n\t\t\t\tif(objectUsage.calls.length > 0) {\n\t\t\t\t\temit(fingerprint, objectUsage);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",
           "reduce": "function (key, values, rereduce) {\n\tif(rereduce)\n\t\treturn sum(values);\n\telse\n\t\treturn values.length;\n}"
       },
       "latestTimestampByFingerprint": {
           "map": "function(doc) {\n\tif(!doc.imports || !doc.primaryType)\n\t\treturn;\n\n\tfor(var i=0; i<doc.imports.length; i++) {\n\t\tvar _import = doc.imports[i];\n\t\tif(_import.fingerprint) {\n\t\t\temit(_import.fingerprint, doc.creationTimestamp);\n\t\t}\n\t}\n}",
           "reduce": "function (key, values, rereduce) {\n\tif(values.length > 0) {\n\t\tvalues = values.sort();\n\t\treturn values[values.length-1];\n\t}\n\telse\n\t\treturn values;\n}"
       }
   }
}